{% extends "base/generic.html" %}
{% load static %}
{% block content %}
    <h2>{{ question.title }}</h2>
    <p>
        {% if question.author.profile.avatar %}
            <img src="{{ question.author.profile.avatar.url }}" width=32 height="32" />
        {% else %}
            <img src="{% static "qa/img/default_avatar.png" %}" width=32 height="32" />
        {% endif %}
        <!-- author detail link not yet defined -->
        <a href="">{{ question.author }}</a> 
        <strong> asked </strong> {{ question.created }}:
    </p>
    <p>{{ question.text }}</p>
    {% if question.tags.all %}
        <p><strong>Tags:</strong> 
            {% for tag in question.tags.all %}
                <a href="{% url 'qa:tag_detail' tag.tag_text %}">{{ tag.tag_text }}</a>
            {% endfor %}
        </p>
    {% endif %}
    <div style="margin-left:20px;margin-top:20px">

    {% if answers %}
        <h4>Answers</h4>

        {% for answer in question.answer_set.all %}
            <hr />
            <p
                class="{% if answer.status == 1 %}text-success{% else %}text-warning{% endif %}">
                {{ answer.get_status_display }}
            </p>
            {% if user.is_authenticated %}
                <form action="{% url 'qa:answer_vote' answer.id '+1' %}" method="GET">
                    <button type="submit">Like</button>
                </form>
                <form action="{% url 'qa:answer_vote' answer.id '-1' %}" method="GET">
                    <button type="submit">Dislike</button>
                </form>
                {% if user == question.author %}
                    <form action="{% url 'qa:mark_answer_as_correct' question.id answer.id %}" method="GET">
                        <button type="submit">Mark answer as correct</button>
                    </form>
                {% endif %}
            {% endif %}
            <p>{{ answer.text }}</p>
            <p class="text-muted">
                {% if answer.author.profile.avatar %}
                    <img src="{{ answer.author.profile.avatar.url }}" width=32 height="32" />
                {% else %}
                    <img src="{% static "qa/img/default_avatar.png" %}" width=32 height="32" />
                {% endif %}
                <a href="">{{ answer.author }}</a> <strong> answered </strong> {{ answer.created }}
            </p>
        {% endfor %}
        {% include "base/paginator.html" with page_obj=answers_page_obj %}
    {% endif %}
    {% if user.is_authenticated %}
        <form action="" method="post">
            {% csrf_token %}
            <table>
                {{ form.as_table }}
            </table>
            <input type="submit" value="Submit" />
        </form>
    {% endif %}
    </div>
{% endblock %}
